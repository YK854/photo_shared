<div class="row justify-content-center pb-3">
  <div class="col-sm-5">
    <div class="mb-2 ml-2">
      <% if @photo.user.id == current_user.id %>
        <%= link_to photo_path(@photo), method: :delete, data: { confirm: "投稿を削除しますか？"}, class: "btn btn-outline-danger btn-sm" do %>
          <i class="bi bi-x-lg"></i>
        <% end %>
      <% end %>
    </div>
    <%= attachment_image_tag(@photo, :picture, :fill, 400, 400, class: "img-thumbnail shadow") %>
    <div class="mt-3 ml-2">
      <%= attachment_image_tag(@photo.user, :image, :fill, 60, 60, fallback: "person-circle.svg", size: "60x60", class: "rounded-circle") %>
      <div class="d-inline-block align-middle text-center mx-5 h5">
        <%= @photo.user.name %>
        <div>
          <i class="bi bi-balloon-heart-fill text-danger"></i>
          <span class="text-secondary"><%= @photo.favorites.count %></span>
          ｜
          <i class="bi bi-chat text-primary pr-1"></i>
          <span class="text-secondary"><%= @photo.comments.count %></span>
        </div>
      </div>
      <!--投稿写真に対してのいいね-->
      <div class="d-inline h2 pl-4">
        <!--ログインしているユーザーが含まれているか判断(いいね機能)-->
        <% if @photo.favorited_by?(current_user) %>
          <%= link_to photo_favorites_path(@photo), method: :delete do %>
            <i class="bi bi-heart-fill text-danger"></i>
          <% end %>
        <% else %>
          <%= link_to photo_favorites_path(@photo), method: :post do %>
            <i class="bi bi-heart text-danger"></i>
          <% end %>
        <% end %>
      </div>
      <!--コメント入力欄,部分テンプレート-->
      <div class="pt-3">
        <div class="p-3 mb-2 bg-danger text-white w-50">
          <%= flash[:alert] %>
        </div>
        <%= form_with(model:[@photo, @comment], local:true) do |f| %>
          <%= f.text_area :post_comment, size: "40x2", placeholder: "50文字以内のコメントを入力して下さい" %></br>
          <%= f.submit "送信", class: "btn btn-outline-primary" %>
        <% end %>
      </div>
    </div>
  </div>
  <!--コメント一覧-->
  <div class="col-sm-4">
    <div class="h2 mt-5">
      <%= @photo.title %>
    </div>
    <div class="h5 text-center py-3 border-bottom">
      <%= @photo.description %>
    </div>

    <div>
      <% @photo.comments.each do |c| %>
        <div class="row my-2">
          <div class="col-sm-2">
            <%= attachment_image_tag(c.user, :image, :fill, 20, 20, fallback: "person-circle.svg", size: "20x20", class: "rounded-circle") %>
          </div>
          <div class="col-sm-10">
            <div class="border rounded-lg rounded-right px-3 py-2">
              <div class="h6">
                <%= c.user.name %>
              </div>
              <div class="text-break">
                <%= c.post_comment %>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>

  </div>

  <div class="col-sm-3">
    <p>部分テンプレート</p>
  </div>
</div>

